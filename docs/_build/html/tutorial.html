
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Tutorial &#8212; dimcat 0.3.0.post1.dev48+gb31e433.d20230210 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Manual" href="manual.html" />
    <link rel="prev" title="dimcat" href="readme.html" />

  <link rel="stylesheet" href="_static/custom.css" type="text/css" />


  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">


          <div class="body" role="main">

  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this heading">¶</a></h1>
<p>In order to run this notebook:</p>
<ul class="simple">
<li><p>create new environment, make it visible to your Jupyter</p>
<ul>
<li><p>for conda do <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">create</span> <span class="pre">--name</span> <span class="pre">{name}</span> <span class="pre">python=3.10</span></code></p></li>
<li><p>activate it and install <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">ipykernel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ipython</span> <span class="pre">kernel</span> <span class="pre">install</span> <span class="pre">--user</span> <span class="pre">--name={name}</span></code></p></li>
</ul>
</li>
<li><p>within the new environment, install requirements, e.g. <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></p></li>
<li><p>clone the corpus: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">--recurse-submodules</span> <span class="pre">-j8</span> <span class="pre">https://github.com/DCMLab/dcml_corpora</span></code></p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">corpus_path</span></code> in the second cell to your local clone.</p></li>
</ul>
<p>If the plots are not displayed and you are in JupyterLab, use <a class="reference external" href="https://plotly.com/python/getting-started/#jupyterlab-support">this guide</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">git</span> <span class="kn">import</span> <span class="n">Repo</span>
<span class="kn">import</span> <span class="nn">dimcat</span> <span class="k">as</span> <span class="nn">dc</span>
<span class="kn">import</span> <span class="nn">ms3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corpus_path</span> <span class="o">=</span> <span class="s2">&quot;~/dcml_corpora&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repo</span> <span class="o">=</span> <span class="n">Repo</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>
<span class="n">notebook_repo</span> <span class="o">=</span> <span class="n">Repo</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">search_parent_directories</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">notebook_repo_path</span> <span class="o">=</span> <span class="n">notebook_repo</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">rev_parse</span><span class="p">(</span><span class="s2">&quot;--show-toplevel&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Notebook repository &#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">notebook_repo_path</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; @ </span><span class="si">{</span><span class="n">notebook_repo</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span><span class="o">.</span><span class="n">hexsha</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data repo &#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; @ </span><span class="si">{</span><span class="n">repo</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span><span class="o">.</span><span class="n">hexsha</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dimcat version </span><span class="si">{</span><span class="n">dc</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ms3 version </span><span class="si">{</span><span class="n">ms3</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Notebook repository &#39;dimcat&#39; @ 2332fcf
Data repo &#39;dcml_corpora&#39; @ e21a5f0
dimcat version 0.2.0.post1.dev109+g2332fcf.d20230210
ms3 version 1.2.2.post0.dev7+gb45016d
</pre></div>
</div>
</div>
</div>
<section id="the-dataset-object">
<h2>The Dataset object<a class="headerlink" href="#the-dataset-object" title="Permalink to this heading">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object represents one or several <a class="reference external" href="https://github.com/DCMLab/dcml_corpora">DCML corpora</a>, depending on which folder(s) you load. By default, DiMCAT will discover all data it can potentially load, but parse only the tabular TSV files, not the scores from which they have been derived.</p>
<section id="initializing-a-dataset">
<h3>Initializing a Dataset<a class="headerlink" href="#initializing-a-dataset" title="Permalink to this heading">¶</a></h3>
<p>Pass a directory to <code class="docutils literal notranslate"><span class="pre">dimcat.Dataset.load()</span></code> to discover and parse all TSV files. The property <code class="docutils literal notranslate"><span class="pre">data</span></code> simply returns an <code class="docutils literal notranslate"><span class="pre">ms3.Parse</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">corpus_path</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[<span class=" -Color -Color-Bold">default</span>|all]
All corpora
-----------
View: This view is called &#39;default&#39;. It
	- excludes fnames that are not contained in the metadata,
	- filters out file extensions requiring conversion (such as .xml), and
	- excludes review files and folders.

                               has   active   scores measures           notes        expanded          events          chords
                          metadata     view detected detected parsed detected parsed detected parsed detected parsed detected parsed
corpus
ABC                            yes  default       70       70     70       70     70       70     70        0      0       70     70
beethoven_piano_sonatas        yes  default       87       87     87       87     87       64     64        0      0       87     87
chopin_mazurkas                yes  default       55       55     55       55     55       55     55        0      0       55     55
corelli                        yes  default      149      149    149      149    149      149    149        0      0      149    149
debussy_suite_bergamasque      yes  default        4        4      4        4      4        4      4        0      0        4      4
dvorak_silhouettes             yes  default       12       12     12       12     12       12     12        0      0       12     12
grieg_lyrical_pieces           yes  default       66       66     66       66     66       66     66        0      0       66     66
liszt_pelerinage               yes  default       19       19     19       19     19       19     19        0      0       19     19
medtner_tales                  yes  default       19       19     19       19     19       19     19        0      0       19     19
mozart_piano_sonatas           yes  default       54       54     54       54     54       54     54        0      0       54     54
schumann_kinderszenen          yes  default       13       13     13       13     13       13     13        0      0       13     13
tchaikovsky_seasons            yes  default       12       12     12       12     12       12     12       12     12       12     12

1438/4787 files are excluded from this view.

1401 files have been excluded based on their subdir.
37 files have been excluded based on their file name.


There are 1 orphans that could not be attributed to any of the respective corpus&#39;s fnames.
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-is-organized-in-facets-and-ids">
<h3>Data is organized in facets and IDs<a class="headerlink" href="#data-is-organized-in-facets-and-ids" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>As you can see, DiMCAT recognized the subfolders of the meta-repository <code class="docutils literal notranslate"><span class="pre">dcml_corpora</span></code> as individual corpora (rows) and shows the number of detected and parsed files per facet (columns).</p></li>
<li><p>The facets that a DCML dataset includes by default are</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">measures</span></code>: feature matrices of partial and complete measure units that make up a score</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notes</span></code>:  feature matrices of all note heads contained in a score</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expanded</span></code>: feature matrices of all DCML harmony labels contained in a score</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">scores</span></code>): since the scores are considered to hold the latest version of the mentioned facets, DiMCAT can extract the information freshly, but for saving RAM it is recommended to simply keep your facets up to date using the <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">extract</span></code> command</p></li>
</ul>
</li>
<li><p>Internally, DiMCAT addresses pieces using index tuples, also called indices or IDs, that take the form <code class="docutils literal notranslate"><span class="pre">('corpus_name',</span> <span class="pre">'piece_name')</span></code>. The list of pieces currently being analysed is stored under the <code class="docutils literal notranslate"><span class="pre">.indices</span></code> field:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;chopin_mazurkas&#39;, &#39;BI162-1op63-1&#39;),
 (&#39;mozart_piano_sonatas&#39;, &#39;K282-3&#39;),
 (&#39;corelli&#39;, &#39;op03n09b&#39;),
 (&#39;grieg_lyrical_pieces&#39;, &#39;op57n05&#39;),
 (&#39;grieg_lyrical_pieces&#39;, &#39;op12n04&#39;),
 (&#39;medtner_tales&#39;, &#39;op26n02&#39;),
 (&#39;ABC&#39;, &#39;n13op130_06&#39;),
 (&#39;corelli&#39;, &#39;op04n09b&#39;),
 (&#39;medtner_tales&#39;, &#39;op34n02&#39;),
 (&#39;dvorak_silhouettes&#39;, &#39;op08n07&#39;)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="accessing-a-facet">
<h3>Accessing a facet<a class="headerlink" href="#accessing-a-facet" title="Permalink to this heading">¶</a></h3>
<p>To inspect a facet concatenated over all pieces, simply call</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="s1">&#39;notes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>mc</th>
      <th>mn</th>
      <th>quarterbeats</th>
      <th>duration_qb</th>
      <th>mc_onset</th>
      <th>mn_onset</th>
      <th>timesig</th>
      <th>staff</th>
      <th>voice</th>
      <th>duration</th>
      <th>...</th>
      <th>nominal_duration</th>
      <th>scalar</th>
      <th>tied</th>
      <th>tpc</th>
      <th>midi</th>
      <th>volta</th>
      <th>chord_id</th>
      <th>name</th>
      <th>octave</th>
      <th>tremolo</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th>interval</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ABC</th>
      <th rowspan="5" valign="top">n01op18-1_01</th>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>3</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>53</td>
      <td>&lt;NA&gt;</td>
      <td>12</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>53</td>
      <td>&lt;NA&gt;</td>
      <td>18</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>65</td>
      <td>&lt;NA&gt;</td>
      <td>0</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>2</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>65</td>
      <td>&lt;NA&gt;</td>
      <td>6</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[1.0, 1.5)</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.5</td>
      <td>1/4</td>
      <td>1/4</td>
      <td>3/4</td>
      <td>3</td>
      <td>1</td>
      <td>1/8</td>
      <td>...</td>
      <td>1/8</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>53</td>
      <td>&lt;NA&gt;</td>
      <td>13</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">tchaikovsky_seasons</th>
      <th rowspan="5" valign="top">op37a12</th>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>2</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0</td>
      <td>72</td>
      <td>&lt;NA&gt;</td>
      <td>1071</td>
      <td>C5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>2</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>-3</td>
      <td>75</td>
      <td>&lt;NA&gt;</td>
      <td>1071</td>
      <td>Eb5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>-4</td>
      <td>80</td>
      <td>&lt;NA&gt;</td>
      <td>1070</td>
      <td>Ab5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0</td>
      <td>84</td>
      <td>&lt;NA&gt;</td>
      <td>1070</td>
      <td>C6</td>
      <td>6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>-4</td>
      <td>92</td>
      <td>&lt;NA&gt;</td>
      <td>1070</td>
      <td>Ab6</td>
      <td>6</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>902522 rows × 21 columns</p>
</div></div></div>
</div>
<p>As you can see, the IDs are included as index levels and the third level indicates the temporal dimensions, the time interval, of each event (here of every note head) expressed in quarter notes.</p>
</section>
<section id="filtering-the-data-to-be-analyzed">
<h3>Filtering the data to be analyzed<a class="headerlink" href="#filtering-the-data-to-be-analyzed" title="Permalink to this heading">¶</a></h3>
<p>The data overview above shows that the <code class="docutils literal notranslate"><span class="pre">expanded</span></code> facet is not available for all 87 pieces included in the <code class="docutils literal notranslate"><span class="pre">beethoven_piano_sonatas</span></code> corpus (i.e., they have not been annotated with harmony labels), so in some cases we might want to filter pieces (i.e., IDs) from the dataset. This is what the objects in the <code class="docutils literal notranslate"><span class="pre">dimcat.filter</span></code> module do: They iterate through the IDs and exclude those that do not fulfill the filter’s criterion.</p>
<p>For example, to filter out those pieces that have not been annotated we instantiate an <code class="docutils literal notranslate"><span class="pre">IsAnnotatedFilter</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_object</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">IsAnnotatedFilter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>All DiMCAT objects working on data come with a <code class="docutils literal notranslate"><span class="pre">.process_data()</span></code> method that takes a dataset and returns a processed copy of the dataset. For example, to apply the filter to our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">annotated</span> <span class="o">=</span> <span class="n">filter_object</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before filtering: </span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">n_indices</span><span class="si">}</span><span class="s2"> IDs.</span><span class="se">\n</span><span class="s2">After filtering: </span><span class="si">{</span><span class="n">annotated</span><span class="o">.</span><span class="n">n_indices</span><span class="si">}</span><span class="s2"> IDs.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before filtering: 560 IDs.
After filtering: 537 IDs.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="applying-pipelinesteps-to-a-dataset">
<h2>Applying PipelineSteps to a Dataset<a class="headerlink" href="#applying-pipelinesteps-to-a-dataset" title="Permalink to this heading">¶</a></h2>
<p>Everything else in DiMCAT is a PipelineStep the various types of which are distributed over several modules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dimcat.filter</span></code>: Filters return a new Dataset where certain IDs have been removed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimcat.plotter</span></code>: Plotters plot analysis (‘processed’) data and potentially output plots as files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimcat.writer</span></code>: Writers output analyzed data to disk.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimcat.grouper</span></code>: Groupers subdivide each of the current ID groups based on a given criterion and return a new Dataset with an altered <code class="docutils literal notranslate"><span class="pre">.indices</span></code> field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimcat.slicer</span></code>: Slicers create for each ID (read: piece) a set of chunks identified by non-overlapping intervals. Any facet retrieved from such a sliced Dataset will be sliced, cutting and duplicating any event that overlaps the interval boundaries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimcat.analyzer</span></code>: Analyzers perform an analysis on a given Dataset and return a new Dataset with the results stored in the <code class="docutils literal notranslate"><span class="pre">.processed</span></code> field.</p></li>
</ul>
<p>As we have seen with the <code class="docutils literal notranslate"><span class="pre">IsAnnotatedFilter</span></code> above, these PipelineSteps come with the method <code class="docutils literal notranslate"><span class="pre">process_data()</span></code> and return a copy of the given Dataset. Out of the first three mentioned types, it is actually the only one returning a potentially modified copy, whereas plotters and writers return an exact copy.</p>
<p>This is different for groupers, slicers, and analyzers which all transform datasets to the point that they output new datatypes, which are subtypes of <code class="docutils literal notranslate"><span class="pre">GroupedData</span></code>, <code class="docutils literal notranslate"><span class="pre">SlicedData</span></code>, and <code class="docutils literal notranslate"><span class="pre">AnalyzedData</span></code> respectively.</p>
<section id="applying-a-slicer">
<h3>Applying a slicer<a class="headerlink" href="#applying-a-slicer" title="Permalink to this heading">¶</a></h3>
<p>Having selected only annotated pieces, we can apply the <code class="docutils literal notranslate"><span class="pre">LocalKeySlicer</span></code> that slices the dataset into segments that remaining in one and the same local key:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">localkey_slices</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">LocalKeySlicer</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">annotated</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dimcat.data.dcml.SlicedDataset
</pre></div>
</div>
</div>
</div>
<p>The type of the new dataset is a hybrid of <code class="docutils literal notranslate"><span class="pre">SlicedData</span></code> (any data processed by a slicer) and <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, the particular type representing for DCML corpora:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">,</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SlicedData</span><span class="p">),</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">,</span> <span class="n">dc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, True)
</pre></div>
</div>
</div>
</div>
<p>This is useful because we can guarantee that sliced data always come with its two defining fields, which are the dictionary <code class="docutils literal notranslate"><span class="pre">sliced</span></code> for storing previously sliced facets, and <code class="docutils literal notranslate"><span class="pre">.slice_info</span></code> for storing information about the slices themselves; regardless of the type of the dataset and its idiosyncratic ways of interacting with this slicing information.</p>
<p>Another thing differentiating <code class="docutils literal notranslate"><span class="pre">SlicedData</span></code> from other data is that it has new IDs which identify pieces rather than slices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before: </span><span class="si">{</span><span class="n">annotated</span><span class="o">.</span><span class="n">n_indices</span><span class="si">}</span><span class="s2"> IDs, after slicing: </span><span class="si">{</span><span class="n">localkey_slices</span><span class="o">.</span><span class="n">n_indices</span><span class="si">}</span><span class="s2"> IDs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Facets that have been sliced so far: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">localkey_slices</span><span class="o">.</span><span class="n">sliced</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before: 537 IDs, after slicing: 3468 IDs
Facets that have been sliced so far: [&#39;expanded&#39;].
</pre></div>
</div>
</div>
</div>
<p>The IDs of the sliced Dataset have multiplied and received a third element, which is the interval specifying the extent of one particular slice in quarter notes. Let’s have a look at the first 10 IDs of the <code class="docutils literal notranslate"><span class="pre">SlicedDataset</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">localkey_slices</span><span class="o">.</span><span class="n">indices</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(0.0, 117.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(117.0, 163.5, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(163.5, 342.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(342.0, 354.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(354.0, 378.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(378.0, 405.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(405.0, 423.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(423.0, 438.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(438.0, 444.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(444.0, 474.0, closed=&#39;left&#39;))]
</pre></div>
</div>
</div>
</div>
<p>The IDs make sure that all facets retrieved from this Dataset will be sliced.</p>
<p>This is True not only for the facet that has been used for slicing (annotation tables in the present case):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">localkey_slices</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="s1">&#39;expanded&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>mc</th>
      <th>mn</th>
      <th>quarterbeats</th>
      <th>duration_qb</th>
      <th>mc_onset</th>
      <th>mn_onset</th>
      <th>timesig</th>
      <th>staff</th>
      <th>voice</th>
      <th>volta</th>
      <th>...</th>
      <th>chord_type</th>
      <th>globalkey_is_minor</th>
      <th>localkey_is_minor</th>
      <th>chord_tones</th>
      <th>added_tones</th>
      <th>root</th>
      <th>bass_note</th>
      <th>alt_label</th>
      <th>pedalend</th>
      <th>placement</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th>localkey_slice</th>
      <th>interval</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="30" valign="top">ABC</th>
      <th rowspan="30" valign="top">n01op18-1_01</th>
      <th rowspan="30" valign="top">[0.0, 117.0)</th>
      <th>[0.0, 3.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[3.0, 6.0)</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 5, 2)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[6.0, 9.0)</th>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[9.0, 15.0)</th>
      <td>4</td>
      <td>4</td>
      <td>9</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(3, 0, -1)</td>
      <td>()</td>
      <td>-1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[15.0, 18.0)</th>
      <td>6</td>
      <td>6</td>
      <td>15</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>Mm7</td>
      <td>False</td>
      <td>False</td>
      <td>(5, 2, -1, 1)</td>
      <td>()</td>
      <td>1</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[18.0, 19.0)</th>
      <td>7</td>
      <td>7</td>
      <td>18</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[19.0, 20.0)</th>
      <td>7</td>
      <td>7</td>
      <td>19</td>
      <td>1.0</td>
      <td>1/4</td>
      <td>1/4</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>m</td>
      <td>False</td>
      <td>False</td>
      <td>(3, 0, 4)</td>
      <td>()</td>
      <td>3</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[20.0, 21.0)</th>
      <td>7</td>
      <td>7</td>
      <td>20</td>
      <td>1.0</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>m</td>
      <td>False</td>
      <td>False</td>
      <td>(-1, 3, 2)</td>
      <td>()</td>
      <td>2</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[21.0, 23.0)</th>
      <td>8</td>
      <td>8</td>
      <td>21</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 0, 4)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[23.0, 24.0)</th>
      <td>8</td>
      <td>8</td>
      <td>23</td>
      <td>1.0</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 5, 2)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[24.0, 27.0)</th>
      <td>9</td>
      <td>9</td>
      <td>24</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[27.0, 30.0)</th>
      <td>10</td>
      <td>10</td>
      <td>27</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 5, 2)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[30.0, 33.0)</th>
      <td>11</td>
      <td>11</td>
      <td>30</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[33.0, 39.0)</th>
      <td>12</td>
      <td>12</td>
      <td>33</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(3, 0, -1)</td>
      <td>()</td>
      <td>-1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[39.0, 41.0)</th>
      <td>14</td>
      <td>14</td>
      <td>39</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>o7</td>
      <td>False</td>
      <td>False</td>
      <td>(8, 5, 4, -1)</td>
      <td>()</td>
      <td>8</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[41.0, 45.0)</th>
      <td>14</td>
      <td>14</td>
      <td>41</td>
      <td>4.0</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>o7</td>
      <td>False</td>
      <td>False</td>
      <td>(8, 5, 2, -1)</td>
      <td>()</td>
      <td>8</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[45.0, 47.0)</th>
      <td>16</td>
      <td>16</td>
      <td>45</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>o7</td>
      <td>False</td>
      <td>False</td>
      <td>(7, -1, 1, -2)</td>
      <td>()</td>
      <td>7</td>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[47.0, 51.0)</th>
      <td>16</td>
      <td>16</td>
      <td>47</td>
      <td>4.0</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>o7</td>
      <td>False</td>
      <td>False</td>
      <td>(7, 4, 1, -2)</td>
      <td>()</td>
      <td>7</td>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[51.0, 52.5)</th>
      <td>18</td>
      <td>18</td>
      <td>51</td>
      <td>1.5</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>m</td>
      <td>False</td>
      <td>False</td>
      <td>(-1, -2, 7)</td>
      <td>(1,)</td>
      <td>2</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[52.5, 54.0)</th>
      <td>18</td>
      <td>18</td>
      <td>105/2</td>
      <td>1.5</td>
      <td>3/8</td>
      <td>3/8</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>m</td>
      <td>False</td>
      <td>False</td>
      <td>(-1, 3, 2)</td>
      <td>()</td>
      <td>2</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[54.0, 56.0)</th>
      <td>19</td>
      <td>19</td>
      <td>54</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 0, 4)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[56.0, 56.5)</th>
      <td>19</td>
      <td>19</td>
      <td>56</td>
      <td>0.5</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 5, 4)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[56.5, 57.0)</th>
      <td>19</td>
      <td>19</td>
      <td>113/2</td>
      <td>0.5</td>
      <td>5/8</td>
      <td>5/8</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>Mm7</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 5, 2, -1)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[57.0, 60.0)</th>
      <td>20</td>
      <td>20</td>
      <td>57</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[60.0, 63.0)</th>
      <td>21</td>
      <td>21</td>
      <td>60</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>M</td>
      <td>False</td>
      <td>False</td>
      <td>(0, 4, 1)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[63.0, 65.0)</th>
      <td>22</td>
      <td>22</td>
      <td>63</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>o7</td>
      <td>False</td>
      <td>False</td>
      <td>(6, -2, 0, -3)</td>
      <td>()</td>
      <td>6</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[65.0, 69.0)</th>
      <td>22</td>
      <td>22</td>
      <td>65</td>
      <td>4.0</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>o7</td>
      <td>False</td>
      <td>False</td>
      <td>(6, 3, 0, -3)</td>
      <td>()</td>
      <td>6</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[69.0, 71.0)</th>
      <td>24</td>
      <td>24</td>
      <td>69</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>Mm7</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 0, 2, -1)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[71.0, 75.0)</th>
      <td>24</td>
      <td>24</td>
      <td>71</td>
      <td>4.0</td>
      <td>1/2</td>
      <td>1/2</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>Mm7</td>
      <td>False</td>
      <td>False</td>
      <td>(1, 5, 2, -1)</td>
      <td>()</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[75.0, 77.0)</th>
      <td>26</td>
      <td>26</td>
      <td>75</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>Mm7</td>
      <td>False</td>
      <td>False</td>
      <td>(0, -1, 1, -2)</td>
      <td>()</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 33 columns</p>
</div></div></div>
</div>
<p>But also for any other facet requested:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">localkey_slices</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="s1">&#39;notes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>mc</th>
      <th>mn</th>
      <th>quarterbeats</th>
      <th>duration_qb</th>
      <th>mc_onset</th>
      <th>mn_onset</th>
      <th>timesig</th>
      <th>staff</th>
      <th>voice</th>
      <th>duration</th>
      <th>...</th>
      <th>nominal_duration</th>
      <th>scalar</th>
      <th>tied</th>
      <th>tpc</th>
      <th>midi</th>
      <th>volta</th>
      <th>chord_id</th>
      <th>name</th>
      <th>octave</th>
      <th>tremolo</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th>localkey_slice</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ABC</th>
      <th rowspan="5" valign="top">n01op18-1_01</th>
      <th rowspan="5" valign="top">[0.0, 117.0)</th>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>3</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>53</td>
      <td>&lt;NA&gt;</td>
      <td>12</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>4</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>53</td>
      <td>&lt;NA&gt;</td>
      <td>18</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>65</td>
      <td>&lt;NA&gt;</td>
      <td>0</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[0.0, 1.0)</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>2</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>65</td>
      <td>&lt;NA&gt;</td>
      <td>6</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[1.0, 1.5)</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.5</td>
      <td>1/4</td>
      <td>1/4</td>
      <td>3/4</td>
      <td>3</td>
      <td>1</td>
      <td>1/8</td>
      <td>...</td>
      <td>1/8</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>53</td>
      <td>&lt;NA&gt;</td>
      <td>13</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">tchaikovsky_seasons</th>
      <th rowspan="5" valign="top">op37a12</th>
      <th rowspan="5" valign="top">[442.0, 528.0)</th>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>2</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0</td>
      <td>72</td>
      <td>&lt;NA&gt;</td>
      <td>1071</td>
      <td>C5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>2</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>-3</td>
      <td>75</td>
      <td>&lt;NA&gt;</td>
      <td>1071</td>
      <td>Eb5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>-4</td>
      <td>80</td>
      <td>&lt;NA&gt;</td>
      <td>1070</td>
      <td>Ab5</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>0</td>
      <td>84</td>
      <td>&lt;NA&gt;</td>
      <td>1070</td>
      <td>C6</td>
      <td>6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[525.0, 526.0)</th>
      <td>176</td>
      <td>176</td>
      <td>525</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>3/4</td>
      <td>1</td>
      <td>1</td>
      <td>1/4</td>
      <td>...</td>
      <td>1/4</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>-4</td>
      <td>92</td>
      <td>&lt;NA&gt;</td>
      <td>1070</td>
      <td>Ab6</td>
      <td>6</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>849662 rows × 21 columns</p>
</div></div></div>
</div>
<p>In both cases we see an additional index level <code class="docutils literal notranslate"><span class="pre">localkey_slice</span></code> containing the intervals of the localkey segments. Notes that originally overlapped a localkey boundary are now split in two with <code class="docutils literal notranslate"><span class="pre">duration_qb</span></code> values adapted (but not <code class="docutils literal notranslate"><span class="pre">duration</span></code> which keeps the original value).</p>
<p>However, we might be interested only in the slices themselves, so we can get the information stored in the field <code class="docutils literal notranslate"><span class="pre">slice_info</span></code> by calling:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">localkey_slices</span><span class="o">.</span><span class="n">get_slice_info</span><span class="p">()[[</span><span class="s1">&#39;duration_qb&#39;</span><span class="p">,</span> <span class="s1">&#39;globalkey&#39;</span><span class="p">,</span> <span class="s1">&#39;localkey&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>duration_qb</th>
      <th>globalkey</th>
      <th>localkey</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th>localkey_slice</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ABC</th>
      <th rowspan="5" valign="top">n01op18-1_01</th>
      <th>[0.0, 117.0)</th>
      <td>117.0</td>
      <td>F</td>
      <td>I</td>
    </tr>
    <tr>
      <th>[117.0, 163.5)</th>
      <td>46.5</td>
      <td>F</td>
      <td>v</td>
    </tr>
    <tr>
      <th>[163.5, 342.0)</th>
      <td>178.5</td>
      <td>F</td>
      <td>V</td>
    </tr>
    <tr>
      <th>[342.0, 354.0)</th>
      <td>12.0</td>
      <td>F</td>
      <td>III</td>
    </tr>
    <tr>
      <th>[354.0, 378.0)</th>
      <td>24.0</td>
      <td>F</td>
      <td>IV</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">tchaikovsky_seasons</th>
      <th rowspan="5" valign="top">op37a12</th>
      <th>[261.0, 303.0)</th>
      <td>42.0</td>
      <td>Ab</td>
      <td>bVI</td>
    </tr>
    <tr>
      <th>[303.0, 309.0)</th>
      <td>6.0</td>
      <td>Ab</td>
      <td>iii/bVI</td>
    </tr>
    <tr>
      <th>[309.0, 399.0)</th>
      <td>90.0</td>
      <td>Ab</td>
      <td>bVI</td>
    </tr>
    <tr>
      <th>[399.0, 442.0)</th>
      <td>43.0</td>
      <td>Ab</td>
      <td>iii/bVI</td>
    </tr>
    <tr>
      <th>[442.0, 528.0)</th>
      <td>86.0</td>
      <td>Ab</td>
      <td>I</td>
    </tr>
  </tbody>
</table>
<p>3468 rows × 3 columns</p>
</div></div></div>
</div>
</section>
<section id="applying-a-grouper">
<h3>Applying a Grouper<a class="headerlink" href="#applying-a-grouper" title="Permalink to this heading">¶</a></h3>
<p>If, for example, we want to analyse localkey segments separately depending on whether they are in major or minor, we could apply a <code class="docutils literal notranslate"><span class="pre">ModeGrouper</span></code>, which can only applied to a Dataset that has already been sliced:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_localkey_slices</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">ModeGrouper</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">)</span>
<span class="n">grouped_localkey_slices</span><span class="o">.</span><span class="n">get_slice_info</span><span class="p">()[[</span><span class="s1">&#39;duration_qb&#39;</span><span class="p">,</span> <span class="s1">&#39;globalkey&#39;</span><span class="p">,</span> <span class="s1">&#39;localkey&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>duration_qb</th>
      <th>globalkey</th>
      <th>localkey</th>
    </tr>
    <tr>
      <th>localkey_is_minor</th>
      <th>corpus</th>
      <th>fname</th>
      <th>localkey_slice</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">False</th>
      <th rowspan="5" valign="top">ABC</th>
      <th rowspan="5" valign="top">n01op18-1_01</th>
      <th>[0.0, 117.0)</th>
      <td>117.0</td>
      <td>F</td>
      <td>I</td>
    </tr>
    <tr>
      <th>[163.5, 342.0)</th>
      <td>178.5</td>
      <td>F</td>
      <td>V</td>
    </tr>
    <tr>
      <th>[342.0, 354.0)</th>
      <td>12.0</td>
      <td>F</td>
      <td>III</td>
    </tr>
    <tr>
      <th>[354.0, 378.0)</th>
      <td>24.0</td>
      <td>F</td>
      <td>IV</td>
    </tr>
    <tr>
      <th>[498.0, 564.0)</th>
      <td>66.0</td>
      <td>F</td>
      <td>I</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">True</th>
      <th rowspan="5" valign="top">tchaikovsky_seasons</th>
      <th rowspan="3" valign="top">op37a11</th>
      <th>[155.0, 166.0)</th>
      <td>11.0</td>
      <td>E</td>
      <td>iv</td>
    </tr>
    <tr>
      <th>[171.0, 180.0)</th>
      <td>9.0</td>
      <td>E</td>
      <td>v</td>
    </tr>
    <tr>
      <th>[224.0, 232.0)</th>
      <td>8.0</td>
      <td>E</td>
      <td>iii</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">op37a12</th>
      <th>[303.0, 309.0)</th>
      <td>6.0</td>
      <td>Ab</td>
      <td>iii/bVI</td>
    </tr>
    <tr>
      <th>[399.0, 442.0)</th>
      <td>43.0</td>
      <td>Ab</td>
      <td>iii/bVI</td>
    </tr>
  </tbody>
</table>
<p>3468 rows × 3 columns</p>
</div></div></div>
</div>
<p>The grouping is displayed as the prepended index level <code class="docutils literal notranslate"><span class="pre">localkey_is_minor</span></code>. In this case the groups are simply called <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>, as can be seen by inspecting the <code class="docutils literal notranslate"><span class="pre">.indices</span></code> dictionary. The keys are tuples whose lengths match the number of applied Groupers so far.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_localkey_slices</span><span class="o">.</span><span class="n">indices</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(0.0, 117.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(117.0, 163.5, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(163.5, 342.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(342.0, 354.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(354.0, 378.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(378.0, 405.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(405.0, 423.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(423.0, 438.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(438.0, 444.0, closed=&#39;left&#39;)),
 (&#39;ABC&#39;, &#39;n01op18-1_01&#39;, Interval(444.0, 474.0, closed=&#39;left&#39;))]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="applying-an-analyzer">
<h2>Applying an Analyzer<a class="headerlink" href="#applying-an-analyzer" title="Permalink to this heading">¶</a></h2>
<p>After having seen the various ways how a Dataset can be reshaped, let us have a look how the various transformations change the result of an analyzer.
To that aim, let’s first initialize the <code class="docutils literal notranslate"><span class="pre">PitchClassVectors</span></code> analyzer with the desired configuration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcv_analyzer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">PitchClassVectors</span><span class="p">(</span><span class="n">pitch_class_format</span><span class="o">=</span><span class="s1">&#39;pc&#39;</span><span class="p">,</span>
                                    <span class="n">weight_grace_durations</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">include_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We want to</p>
<ul class="simple">
<li><p>see pitch classes 0-12 (as opposed to the defautl <code class="docutils literal notranslate"><span class="pre">tpc</span></code>, i.e. tonal pitch classes on the line of fifth),</p></li>
<li><p>include grace notes, which usually have duration 0, by halving their note values,</p></li>
<li><p>normalize the resulting vectors, and</p></li>
<li><p>include zero vectors where no notes occur (i.e. for completely silent segments).</p></li>
</ul>
<p>We start by applying this analyzer to the filtered dataset, in which all pieces are excluded that do not contain annotations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">annotated_pieces_pcvs</span> <span class="o">=</span> <span class="n">pcv_analyzer</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">annotated</span><span class="p">)</span>
<span class="n">annotated_pieces_pcvs</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ABC</th>
      <th>n01op18-1_01</th>
      <td>0.184561</td>
      <td>0.055635</td>
      <td>0.070421</td>
      <td>0.042324</td>
      <td>0.084489</td>
      <td>0.137893</td>
      <td>0.029651</td>
      <td>0.128686</td>
      <td>0.044994</td>
      <td>0.081221</td>
      <td>0.099793</td>
      <td>0.040332</td>
    </tr>
    <tr>
      <th>n01op18-1_02</th>
      <td>0.080528</td>
      <td>0.066491</td>
      <td>0.150705</td>
      <td>0.024917</td>
      <td>0.097261</td>
      <td>0.114579</td>
      <td>0.039483</td>
      <td>0.107511</td>
      <td>0.019767</td>
      <td>0.182614</td>
      <td>0.087874</td>
      <td>0.028271</td>
    </tr>
    <tr>
      <th>n01op18-1_03</th>
      <td>0.215696</td>
      <td>0.060841</td>
      <td>0.106149</td>
      <td>0.030421</td>
      <td>0.079207</td>
      <td>0.122087</td>
      <td>0.017152</td>
      <td>0.123301</td>
      <td>0.056958</td>
      <td>0.072411</td>
      <td>0.080825</td>
      <td>0.034951</td>
    </tr>
    <tr>
      <th>n01op18-1_04</th>
      <td>0.183797</td>
      <td>0.036084</td>
      <td>0.085030</td>
      <td>0.027207</td>
      <td>0.085792</td>
      <td>0.142276</td>
      <td>0.027104</td>
      <td>0.151199</td>
      <td>0.041352</td>
      <td>0.108558</td>
      <td>0.077516</td>
      <td>0.034085</td>
    </tr>
    <tr>
      <th>n02op18-2_01</th>
      <td>0.072496</td>
      <td>0.040254</td>
      <td>0.195718</td>
      <td>0.034508</td>
      <td>0.088217</td>
      <td>0.032877</td>
      <td>0.085095</td>
      <td>0.130405</td>
      <td>0.019561</td>
      <td>0.128167</td>
      <td>0.041636</td>
      <td>0.131068</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">grieg_lyrical_pieces</th>
      <th>op47n04</th>
      <td>NaN</td>
      <td>0.025747</td>
      <td>0.385170</td>
      <td>NaN</td>
      <td>0.038105</td>
      <td>NaN</td>
      <td>0.024717</td>
      <td>0.012358</td>
      <td>0.041195</td>
      <td>0.447992</td>
      <td>0.004119</td>
      <td>0.020597</td>
    </tr>
    <tr>
      <th>op62n03</th>
      <td>NaN</td>
      <td>0.097554</td>
      <td>0.107645</td>
      <td>0.037920</td>
      <td>0.247401</td>
      <td>NaN</td>
      <td>0.067584</td>
      <td>0.015291</td>
      <td>0.112538</td>
      <td>0.174924</td>
      <td>0.007339</td>
      <td>0.131804</td>
    </tr>
    <tr>
      <th>op65n02</th>
      <td>NaN</td>
      <td>0.146921</td>
      <td>0.095015</td>
      <td>0.028152</td>
      <td>0.171261</td>
      <td>0.023460</td>
      <td>0.089150</td>
      <td>0.018768</td>
      <td>0.100880</td>
      <td>0.214956</td>
      <td>0.009384</td>
      <td>0.102053</td>
    </tr>
    <tr>
      <th>liszt_pelerinage</th>
      <th>160.03_Pastorale</th>
      <td>NaN</td>
      <td>0.065248</td>
      <td>0.005674</td>
      <td>0.051064</td>
      <td>0.320922</td>
      <td>NaN</td>
      <td>0.103901</td>
      <td>NaN</td>
      <td>0.081915</td>
      <td>0.072695</td>
      <td>0.005319</td>
      <td>0.293262</td>
    </tr>
    <tr>
      <th>schumann_kinderszenen</th>
      <th>n10</th>
      <td>NaN</td>
      <td>0.076590</td>
      <td>0.008671</td>
      <td>0.229769</td>
      <td>0.063584</td>
      <td>0.023121</td>
      <td>0.104046</td>
      <td>0.060694</td>
      <td>0.122832</td>
      <td>NaN</td>
      <td>0.109827</td>
      <td>0.200867</td>
    </tr>
  </tbody>
</table>
<p>537 rows × 12 columns</p>
</div></div></div>
</div>
<p>Applying the same analyzer to the Dataset sliced by localkey segments yields one vector per segment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">localkey_segment_pcvs</span> <span class="o">=</span> <span class="n">pcv_analyzer</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">)</span>
<span class="n">localkey_segment_pcvs</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th>localkey_slice</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ABC</th>
      <th rowspan="5" valign="top">n01op18-1_01</th>
      <th>[0.0, 117.0)</th>
      <td>0.198730</td>
      <td>0.018413</td>
      <td>0.083175</td>
      <td>0.025397</td>
      <td>0.081905</td>
      <td>0.207937</td>
      <td>0.020317</td>
      <td>0.119683</td>
      <td>0.007619</td>
      <td>0.111111</td>
      <td>0.099048</td>
      <td>0.026667</td>
    </tr>
    <tr>
      <th>[117.0, 163.5)</th>
      <td>0.171348</td>
      <td>0.042135</td>
      <td>0.103933</td>
      <td>0.181180</td>
      <td>0.018258</td>
      <td>0.042135</td>
      <td>0.053371</td>
      <td>0.168539</td>
      <td>0.058989</td>
      <td>0.036517</td>
      <td>0.049157</td>
      <td>0.074438</td>
    </tr>
    <tr>
      <th>[163.5, 342.0)</th>
      <td>0.207028</td>
      <td>0.005819</td>
      <td>0.118621</td>
      <td>0.021486</td>
      <td>0.132274</td>
      <td>0.102059</td>
      <td>0.022829</td>
      <td>0.209490</td>
      <td>0.035810</td>
      <td>0.049463</td>
      <td>0.016115</td>
      <td>0.079006</td>
    </tr>
    <tr>
      <th>[354.0, 378.0)</th>
      <td>0.081433</td>
      <td>0.006515</td>
      <td>0.045603</td>
      <td>0.133550</td>
      <td>0.003257</td>
      <td>0.081433</td>
      <td>NaN</td>
      <td>0.159609</td>
      <td>NaN</td>
      <td>0.071661</td>
      <td>0.416938</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[378.0, 405.0)</th>
      <td>0.014085</td>
      <td>0.154930</td>
      <td>0.084507</td>
      <td>0.045775</td>
      <td>0.204225</td>
      <td>0.066901</td>
      <td>NaN</td>
      <td>0.176056</td>
      <td>NaN</td>
      <td>0.056338</td>
      <td>0.197183</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>mozart_piano_sonatas</th>
      <th>K331-3</th>
      <th>[137.0, 144.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.022346</td>
      <td>0.379888</td>
      <td>NaN</td>
      <td>0.134078</td>
      <td>0.075419</td>
      <td>NaN</td>
      <td>0.120112</td>
      <td>NaN</td>
      <td>0.268156</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">tchaikovsky_seasons</th>
      <th rowspan="3" valign="top">op37a02</th>
      <th>[34.0, 38.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.097561</td>
      <td>0.097561</td>
      <td>NaN</td>
      <td>0.121951</td>
      <td>0.195122</td>
      <td>NaN</td>
      <td>0.097561</td>
      <td>NaN</td>
      <td>0.390244</td>
    </tr>
    <tr>
      <th>[150.0, 154.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.097561</td>
      <td>0.097561</td>
      <td>NaN</td>
      <td>0.121951</td>
      <td>0.195122</td>
      <td>NaN</td>
      <td>0.097561</td>
      <td>NaN</td>
      <td>0.390244</td>
    </tr>
    <tr>
      <th>[294.0, 298.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.116279</td>
      <td>0.116279</td>
      <td>NaN</td>
      <td>0.116279</td>
      <td>0.186047</td>
      <td>NaN</td>
      <td>0.093023</td>
      <td>NaN</td>
      <td>0.372093</td>
    </tr>
    <tr>
      <th>op37a12</th>
      <th>[303.0, 309.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.281250</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.125000</td>
      <td>0.093750</td>
      <td>0.187500</td>
      <td>NaN</td>
      <td>0.218750</td>
      <td>0.093750</td>
    </tr>
  </tbody>
</table>
<p>3468 rows × 12 columns</p>
</div></div></div>
</div>
<p>Applying a <code class="docutils literal notranslate"><span class="pre">PitchClassVectors</span></code> Analyzer to the localkey segments that have been grouped by keys, seems to not make much of a difference
(except that this one here does not normalize):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_localkey_pcvs</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">PitchClassVectors</span><span class="p">(</span><span class="n">pitch_class_format</span><span class="o">=</span><span class="s1">&#39;pc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">grouped_localkey_slices</span><span class="p">)</span>
<span class="n">grouped_localkey_pcvs</span><span class="o">.</span><span class="n">get_group_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
    </tr>
    <tr>
      <th>localkey_is_minor</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>38232.886712</td>
      <td>21674.846314</td>
      <td>39868.293621</td>
      <td>25266.823683</td>
      <td>35823.829104</td>
      <td>32468.277940</td>
      <td>23832.922872</td>
      <td>40380.157915</td>
      <td>23658.902808</td>
      <td>37866.390984</td>
      <td>26619.865639</td>
      <td>29551.462858</td>
    </tr>
    <tr>
      <th>True</th>
      <td>21862.261310</td>
      <td>12444.749603</td>
      <td>19534.402183</td>
      <td>11675.217163</td>
      <td>20465.950893</td>
      <td>16199.250099</td>
      <td>13081.539583</td>
      <td>21818.557440</td>
      <td>13260.370536</td>
      <td>18478.893552</td>
      <td>11426.841567</td>
      <td>16627.950794</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_localkey_pcvs</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
    </tr>
    <tr>
      <th>corpus</th>
      <th>fname</th>
      <th>localkey_slice</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">ABC</th>
      <th rowspan="5" valign="top">n01op18-1_01</th>
      <th>[0.0, 117.0)</th>
      <td>78.25</td>
      <td>7.25</td>
      <td>32.75</td>
      <td>10.00</td>
      <td>32.00</td>
      <td>81.50</td>
      <td>8.00</td>
      <td>46.75</td>
      <td>3.0</td>
      <td>43.25</td>
      <td>38.75</td>
      <td>10.50</td>
    </tr>
    <tr>
      <th>[117.0, 163.5)</th>
      <td>30.50</td>
      <td>7.50</td>
      <td>18.50</td>
      <td>32.25</td>
      <td>3.25</td>
      <td>7.50</td>
      <td>9.50</td>
      <td>30.00</td>
      <td>10.5</td>
      <td>6.50</td>
      <td>8.75</td>
      <td>13.25</td>
    </tr>
    <tr>
      <th>[163.5, 342.0)</th>
      <td>115.50</td>
      <td>3.25</td>
      <td>66.00</td>
      <td>12.00</td>
      <td>73.75</td>
      <td>57.00</td>
      <td>12.75</td>
      <td>117.00</td>
      <td>20.0</td>
      <td>27.50</td>
      <td>9.00</td>
      <td>44.00</td>
    </tr>
    <tr>
      <th>[354.0, 378.0)</th>
      <td>6.25</td>
      <td>0.50</td>
      <td>3.50</td>
      <td>10.25</td>
      <td>0.25</td>
      <td>6.25</td>
      <td>NaN</td>
      <td>12.25</td>
      <td>NaN</td>
      <td>5.50</td>
      <td>32.00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>[378.0, 405.0)</th>
      <td>1.00</td>
      <td>11.00</td>
      <td>6.00</td>
      <td>3.25</td>
      <td>14.50</td>
      <td>4.75</td>
      <td>NaN</td>
      <td>12.50</td>
      <td>NaN</td>
      <td>4.00</td>
      <td>14.00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>mozart_piano_sonatas</th>
      <th>K331-3</th>
      <th>[137.0, 144.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.50</td>
      <td>8.50</td>
      <td>NaN</td>
      <td>3.00</td>
      <td>1.50</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>NaN</td>
      <td>6.00</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">tchaikovsky_seasons</th>
      <th rowspan="3" valign="top">op37a02</th>
      <th>[34.0, 38.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>[150.0, 154.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>[294.0, 298.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>2.50</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>NaN</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>op37a12</th>
      <th>[303.0, 309.0)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>1.50</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.50</td>
      <td>1.50</td>
    </tr>
  </tbody>
</table>
<p>3468 rows × 12 columns</p>
</div></div></div>
</div>
<p>However, the previous grouping allows us to iterate through the grouped pitch class vectors, e.g. for summing them up for all segments in major and minor respectively:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">mode</span><span class="p">,),</span> <span class="n">pcvs</span> <span class="ow">in</span> <span class="n">grouped_localkey_pcvs</span><span class="o">.</span><span class="n">iter_group_results</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PITCH CLASS PROFILE FOR ALL </span><span class="si">{</span><span class="s1">&#39;MINOR&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;MAJOR&#39;</span><span class="si">}</span><span class="s2"> SEGMENTS:&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">pcvs</span> <span class="o">/</span> <span class="n">pcvs</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PITCH CLASS PROFILE FOR ALL MAJOR SEGMENTS:
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pc
0     0.101888
1     0.057762
2     0.106246
3     0.067334
4     0.095468
5     0.086526
6     0.063513
7     0.107610
8     0.063049
9     0.100911
10    0.070940
11    0.078753
Name: duration_qb, dtype: float64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PITCH CLASS PROFILE FOR ALL MINOR SEGMENTS:
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pc
0     0.111046
1     0.063211
2     0.099222
3     0.059302
4     0.103954
5     0.082281
6     0.066446
7     0.110824
8     0.067354
9     0.093861
10    0.058041
11    0.084459
Name: duration_qb, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="analyzing-slice-infos">
<h3>Analyzing slice infos<a class="headerlink" href="#analyzing-slice-infos" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lk_per_piece</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">PieceGrouper</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">)</span>
<span class="n">lokalkeys_per_piece</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">LocalKeySequence</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">lk_per_piece</span><span class="p">)</span>
<span class="n">lokalkeys_per_piece</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">lk_per_piece</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">PieceGrouper</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">localkey_slices</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">lokalkeys_per_piece</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">LocalKeySequence</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">lk_per_piece</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">lokalkeys_per_piece</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>

<span class="nn">File ~/PycharmProjects/dimcat/src/dimcat/data/base.py:517,</span> in <span class="ni">AnalyzedData.get_results</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">515</span> <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">516</span>     <span class="n">result_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result_object</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">517</span>     <span class="k">return</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>

<span class="nn">File ~/PycharmProjects/dimcat/src/dimcat/data/result.py:49,</span> in <span class="ni">Result.get_results</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">49</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concat_results</span><span class="p">()</span>

<span class="nn">File ~/PycharmProjects/dimcat/src/dimcat/data/result.py:42,</span> in <span class="ni">Result._concat_results</span><span class="nt">(self, index_result_dict, level_names)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">index_result_dict</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">42</span>     <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">level_names</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;level_names = </span><span class="si">{</span><span class="n">level_names</span><span class="si">}</span><span class="s2">; nlevels = </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dimcat/lib/python3.10/site-packages/pandas/util/_decorators.py:331,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">_format_argument_list</span><span class="p">(</span><span class="n">allow_args</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dimcat/lib/python3.10/site-packages/pandas/core/indexes/multi.py:3821,</span> in <span class="ni">MultiIndex.set_names</span><span class="nt">(self, names, level, inplace)</span>
<span class="g g-Whitespace">   </span><span class="mi">3819</span> <span class="nd">@deprecate_nonkeyword_arguments</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allowed_args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="s2">&quot;names&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">   </span><span class="mi">3820</span> <span class="k">def</span> <span class="nf">set_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiIndex</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3821</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_names</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dimcat/lib/python3.10/site-packages/pandas/util/_decorators.py:331,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">_format_argument_list</span><span class="p">(</span><span class="n">allow_args</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dimcat/lib/python3.10/site-packages/pandas/core/indexes/base.py:1959,</span> in <span class="ni">Index.set_names</span><span class="nt">(self, names, level, inplace)</span>
<span class="g g-Whitespace">   </span><span class="mi">1956</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1957</span>     <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1959</span> <span class="n">idx</span><span class="o">.</span><span class="n">_set_names</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1960</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1961</span>     <span class="k">return</span> <span class="n">idx</span>

<span class="nn">File ~/miniconda3/envs/dimcat/lib/python3.10/site-packages/pandas/core/indexes/multi.py:1474,</span> in <span class="ni">MultiIndex._set_names</span><span class="nt">(self, names, level, validate)</span>
<span class="g g-Whitespace">   </span><span class="mi">1472</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of names must match length of level.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1473</span>     <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlevels</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1474</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1475</span>             <span class="s2">&quot;Length of names must match number of levels in MultiIndex.&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1476</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1478</span> <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1479</span>     <span class="n">level</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlevels</span><span class="p">)</span>

<span class="ne">ValueError</span>: Length of names must match number of levels in MultiIndex.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_localkeys</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">LocalKeyUnique</span><span class="p">()</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">lk_per_piece</span><span class="p">)</span>
<span class="n">unique_localkeys</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


          </div>

        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">dimcat</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-dataset-object">The Dataset object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#applying-pipelinesteps-to-a-dataset">Applying PipelineSteps to a Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#applying-an-analyzer">Applying an Analyzer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="manual.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/index.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">Module Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="readme.html" title="previous chapter">dimcat</a></li>
      <li>Next: <a href="manual.html" title="next chapter">Manual</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Digital and Cognitive Musicology Lab @ École Polytechnique Fédérale de Lausanne.

      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>

      |
      <a href="_sources/tutorial.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>




  </body>
</html>
